<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/css/admin.css" />
  <title>
    <%= selectedCategory ? selectedCategory.name : "Admin Panel" %> - Foods
  </title>
</head>

<body>
  <div class="container">
    <h1>üçΩÔ∏è <%= selectedCategory ? selectedCategory.name : 'Category not found' %></h1>

    <% if (selectedCategory) { %>
      <form action="/foods" method="POST" enctype="multipart/form-data" class="food-form">
        <input type="hidden" name="category" value="<%= selectedCategory._id %>">
        <input type="text" name="name" placeholder="Food Name" required>
        <input type="text" name="description" placeholder="Description" required>
        <input type="file" name="imageUrl" accept="image/*" required> 
        <input type="number" name="price" placeholder="Price ($)" required>
        <button type="submit" class="create">‚ûï Create</button>
      </form>
    <% } %>
  </div>

  <div class="food-list">
    <% if (selectedCategory) { %>
      <% selectedCategory.foods.forEach((food) => { %>
        <div class="food-items">
          <div class="food">
            <img src="<%= food.imageUrl %>" alt="<%= food.name %>" />
            <div class="food-info">
              <h3><%= food.name %></h3>
              <p><%= food.description %></p>
              <p><strong>$<%= food.price %></strong></p>
              <div class="food-buttons">
                <button onclick="openEditModal('<%= food._id %>','<%= food.name %>','<%= food.description %>','<%= food.imageUrl %>','<%= food.price %>','<%= food.category %>')">‚úèÔ∏è Edit</button>
                <div id="foods-<%= food._id %>">
                  <button onclick="deleteFood('<%= food._id %>')">üóëÔ∏è Delete</button>
                </div>
                
              </div>
            </div>
          </div>
        </div>
      <% }) %>
    <% } else { %>
      <% categories.forEach((category) => { %>
        <h2><%= category.name %> Taomlari</h2>
        <% category.foods.forEach((food) => { %>
          <div class="food-items">
            <div class="food">
              <img src="<%= food.imageUrl %>" alt="<%= food.name %>" />
              <div class="food-info">
                <h3><%= food.name %></h3>
                <p><%= food.description %></p>
                <p><strong>$<%= food.price %></strong></p>
                <div class="food-buttons">
                  <button onclick="openEditModal('<%= food._id %>', '<%= food.name %>', '<%= food.description %>', '<%= food.price %>')">‚úèÔ∏è Edit</button>
                  <div id="foods-<%= food._id %>">
                    <button onclick="deleteFood('<%= food._id %>')">üóëÔ∏è Delete</button>
                  </div>
                  
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      <% }) %>
    <% } %>
  </div>
  <div class="modal" id="editModal">
    <div class="modal-content">
      <h3>‚úèÔ∏è Edit Food</h3>
      <form method="POST" id="editForm" enctype="multipart/form-data">
        <input type="hidden" name="id" id="editId">
        <input type="text" name="name" id="editName" required>
        <input type="text" name="description" id="editDescription" required>
        <input type="file" name="imageUrl" id="editImage"> 
        <input type="number" name="price" id="editPrice" required>
        <div class="modal-buttons">
          <button type="submit">üíæ Save</button>
          <button type="button" onclick="closeModal()">‚ùå Cancel</button>
        </div>
      </form>
    </div>
  </div>
  

  <script src="/js/admin.js"></script>
</body>

</html>
